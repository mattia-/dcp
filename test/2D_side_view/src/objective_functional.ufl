# UFL file for definition of the objective functional
#
# define mesh dimension
cell = triangle

# define function spaces
V = VectorElement ("Lagrange", cell, 2)
Q = FiniteElement ("Lagrange", cell, 1)

# define coefficients
sigma_1 = Constant (cell)
sigma_2 = Constant (cell)
u = Coefficient (V)
U = Coefficient (V)
p = Coefficient (Q)
P = Coefficient (Q)
g = Coefficient (Q)

# define expression of functional
J = 0.5 * inner (u - U, u - U) * dx (1) \
    + 0.5 * inner (p - P, p - P) * dx (1) \
    + 0.5 * sigma_1 * inner (g, g) * ds (2) \
    + 0.5 * sigma_2 * inner (grad (g), grad (g)) * ds (2)


# add functional to list of forms
forms = [J]
